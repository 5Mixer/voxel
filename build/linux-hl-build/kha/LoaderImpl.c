// Generated by HLC 4.1.3 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <kha/LoaderImpl.h>
#include <kha/korehl/Sound.h>
#include <hl/types/ArrayDyn.h>
extern hl_type t$kha_korehl_Sound;
extern hl_type t$_dyn;
extern hl_type t$hl_types_ArrayDyn;
void kha_korehl_Sound_new(kha__korehl__Sound,String);
extern hl_type t$String;
#include <hl/natives.h>
extern String s$wav;
extern String s$ogg;
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
extern String s$readable;
bool Reflect_hasField(vdynamic*,String);
extern hl_type t$_bool;
kha__Image kha_Image_fromFile(String,bool);
extern String s$png;
extern String s$jpg;
extern String s$hdr;
#include <haxe/io/Bytes.h>
extern hl_type t$kha_internal_BytesBlob;
extern hl_type t$haxe_io_Bytes;
void haxe_io_Bytes_new(haxe__io__Bytes,vbyte*,int);
void kha_internal_BytesBlob_new(kha__internal__BytesBlob,haxe__io__Bytes);
extern hl_type t$kha_Kravur;
void kha_Kravur_new(kha__Kravur,kha__internal__BytesBlob,int*);
extern hl_type t$fun_11ee11d;
#include <kha/korehl/Video.h>
extern hl_type t$kha_korehl_Video;
void kha_korehl_Video_new(kha__korehl__Video,String);
extern String s$;

void kha_LoaderImpl_loadSoundFromDescription(vdynamic* r0,vclosure* r1,vclosure* r2) {
	String r8;
	kha__korehl__Sound r4;
	hl__types__ArrayDyn r6;
	vdynamic *r5;
	int r7;
	if( r1 == NULL ) hl_null_access();
	r4 = (kha__korehl__Sound)hl_alloc_obj(&t$kha_korehl_Sound);
	if( r0 == NULL ) hl_null_access();
	r5 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,10018423/*files*/,&t$_dyn);
	r6 = (hl__types__ArrayDyn)hl_dyn_castp(&r5,&t$_dyn,&t$hl_types_ArrayDyn);
	if( r6 == NULL ) hl_null_access();
	r7 = 0;
	r5 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r6->$type->vobj_proto[0])(r6,r7);
	r8 = (String)r5;
	kha_korehl_Sound_new(r4,r8);
	r1->hasValue ? ((void (*)(vdynamic*,kha__Sound))r1->fun)((vdynamic*)r1->value,((kha__Sound)r4)) : ((void (*)(kha__Sound))r1->fun)(((kha__Sound)r4));
	return;
}

hl__types__ArrayObj kha_LoaderImpl_getSoundFormats() {
	String r4;
	hl__types__ArrayObj r0;
	hl_type *r2;
	int r3;
	varray *r1;
	r2 = &t$String;
	r3 = 2;
	r1 = hl_alloc_array(r2,r3);
	r4 = (String)s$wav;
	r3 = 0;
	((String*)(r1 + 1))[r3] = r4;
	r4 = (String)s$ogg;
	r3 = 1;
	((String*)(r1 + 1))[r3] = r4;
	r0 = hl_types_ArrayObj_alloc(r1);
	return r0;
}

void kha_LoaderImpl_loadImageFromDescription(vdynamic* r0,vclosure* r1,vclosure* r2) {
	String r5;
	kha__Image r7;
	bool r3;
	hl__types__ArrayDyn r8;
	vdynamic *r4;
	int r9;
	r5 = (String)s$readable;
	r3 = Reflect_hasField(r0,r5);
	if( !r3 ) goto label$00c322a_3_9;
	if( r0 == NULL ) hl_null_access();
	r4 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,495394175/*readable*/,&t$_dyn);
	r3 = (bool)hl_dyn_casti(&r4,&t$_dyn,&t$_bool);
	if( !r3 ) goto label$00c322a_3_9;
	r3 = true;
	goto label$00c322a_3_10;
	label$00c322a_3_9:
	r3 = false;
	label$00c322a_3_10:
	if( r1 == NULL ) hl_null_access();
	if( r0 == NULL ) hl_null_access();
	r4 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,10018423/*files*/,&t$_dyn);
	r8 = (hl__types__ArrayDyn)hl_dyn_castp(&r4,&t$_dyn,&t$hl_types_ArrayDyn);
	if( r8 == NULL ) hl_null_access();
	r9 = 0;
	r4 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r8->$type->vobj_proto[0])(r8,r9);
	r5 = (String)r4;
	r7 = kha_Image_fromFile(r5,r3);
	r1->hasValue ? ((void (*)(vdynamic*,kha__Image))r1->fun)((vdynamic*)r1->value,r7) : ((void (*)(kha__Image))r1->fun)(r7);
	return;
}

hl__types__ArrayObj kha_LoaderImpl_getImageFormats() {
	String r4;
	hl__types__ArrayObj r0;
	hl_type *r2;
	int r3;
	varray *r1;
	r2 = &t$String;
	r3 = 3;
	r1 = hl_alloc_array(r2,r3);
	r4 = (String)s$png;
	r3 = 0;
	((String*)(r1 + 1))[r3] = r4;
	r4 = (String)s$jpg;
	r3 = 1;
	((String*)(r1 + 1))[r3] = r4;
	r4 = (String)s$hdr;
	r3 = 2;
	((String*)(r1 + 1))[r3] = r4;
	r0 = hl_types_ArrayObj_alloc(r1);
	return r0;
}

void kha_LoaderImpl_loadBlobFromDescription(vdynamic* r0,vclosure* r1,vclosure* r2) {
	String r10;
	haxe__io__Bytes r16;
	kha__internal__BytesBlob r15;
	hl__types__ArrayDyn r8;
	int *r11, *r13;
	vdynamic *r7;
	vbyte *r6, *r12, *r14;
	int r3, r5, r9;
	r3 = 0;
	r5 = 0;
	if( r0 == NULL ) hl_null_access();
	r7 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,10018423/*files*/,&t$_dyn);
	r8 = (hl__types__ArrayDyn)hl_dyn_castp(&r7,&t$_dyn,&t$hl_types_ArrayDyn);
	if( r8 == NULL ) hl_null_access();
	r9 = 0;
	r7 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r8->$type->vobj_proto[0])(r8,r9);
	r10 = (String)r7;
	if( r10 == NULL ) hl_null_access();
	r6 = r10->bytes;
	r11 = &r5;
	r9 = 0;
	r12 = hl_utf16_to_utf8(r6,r9,r11);
	r13 = &r3;
	r14 = hl_kore_file_contents(r12,r13);
	if( r1 == NULL ) hl_null_access();
	r15 = (kha__internal__BytesBlob)hl_alloc_obj(&t$kha_internal_BytesBlob);
	r16 = (haxe__io__Bytes)hl_alloc_obj(&t$haxe_io_Bytes);
	haxe_io_Bytes_new(r16,r14,r3);
	kha_internal_BytesBlob_new(r15,r16);
	r1->hasValue ? ((void (*)(vdynamic*,kha__internal__BytesBlob))r1->fun)((vdynamic*)r1->value,r15) : ((void (*)(kha__internal__BytesBlob))r1->fun)(r15);
	return;
}

void kha_LoaderImpl_loadFontFromDescription__$1(vclosure* r0,kha__internal__BytesBlob r1) {
	kha__Kravur r3;
	int *r4;
	if( r0 == NULL ) hl_null_access();
	r3 = (kha__Kravur)hl_alloc_obj(&t$kha_Kravur);
	r4 = NULL;
	kha_Kravur_new(r3,r1,r4);
	r0->hasValue ? ((void (*)(vdynamic*,kha__Kravur))r0->fun)((vdynamic*)r0->value,r3) : ((void (*)(kha__Kravur))r0->fun)(r3);
	return;
}

void kha_LoaderImpl_loadFontFromDescription(vdynamic* r0,vclosure* r1,vclosure* r2) {
	vclosure *r4;
	r4 = hl_alloc_closure_ptr(&t$fun_11ee11d,kha_LoaderImpl_loadFontFromDescription__$1,r1);
	kha_LoaderImpl_loadBlobFromDescription(r0,r4,r2);
	return;
}

void kha_LoaderImpl_loadVideoFromDescription(vdynamic* r0,vclosure* r1,vclosure* r2) {
	String r8;
	kha__korehl__Video r4;
	hl__types__ArrayDyn r6;
	vdynamic *r5;
	int r7;
	if( r1 == NULL ) hl_null_access();
	r4 = (kha__korehl__Video)hl_alloc_obj(&t$kha_korehl_Video);
	if( r0 == NULL ) hl_null_access();
	r5 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,10018423/*files*/,&t$_dyn);
	r6 = (hl__types__ArrayDyn)hl_dyn_castp(&r5,&t$_dyn,&t$hl_types_ArrayDyn);
	if( r6 == NULL ) hl_null_access();
	r7 = 0;
	r5 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r6->$type->vobj_proto[0])(r6,r7);
	r8 = (String)r5;
	kha_korehl_Video_new(r4,r8);
	r1->hasValue ? ((void (*)(vdynamic*,kha__Video))r1->fun)((vdynamic*)r1->value,((kha__Video)r4)) : ((void (*)(kha__Video))r1->fun)(((kha__Video)r4));
	return;
}

hl__types__ArrayObj kha_LoaderImpl_getVideoFormats() {
	String r1;
	hl__types__ArrayObj r7;
	hl_type *r9;
	int *r3;
	varray *r8;
	int r2, r5, r6;
	vbyte *r0, *r4;
	r0 = hl_kore_video_format();
	r1 = (String)s$;
	r2 = 0;
	r3 = &r2;
	if( r1 == NULL ) hl_null_access();
	r5 = 0;
	r4 = hl_utf8_to_utf16(r0,r5,r3);
	r1->bytes = r4;
	r6 = 2;
	r5 = r6 == 0 ? 0 : r2 / r6;
	r1->length = r5;
	r9 = &t$String;
	r5 = 1;
	r8 = hl_alloc_array(r9,r5);
	r5 = 0;
	((String*)(r8 + 1))[r5] = r1;
	r7 = hl_types_ArrayObj_alloc(r8);
	return r7;
}

