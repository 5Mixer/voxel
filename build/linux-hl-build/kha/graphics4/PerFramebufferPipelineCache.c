// Generated by HLC 4.1.3 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <kha/graphics4/PerFramebufferPipelineCache.h>
int kha_graphics4_PerFramebufferPipelineCache_hash(kha__graphics4__PerFramebufferPipelineCache,hl__types__ArrayBytes_Int,int);
#include <kha/graphics4/PipelineState.h>
#include <haxe/Exception.h>
#include <hl/types/ArrayDyn.h>
#include <haxe/Log.h>
extern hl_type t$kha_graphics4_InternalPipeline;
#include <hl/natives.h>
hl__types__ArrayObj hl_types_ArrayObj_alloc(varray*);
void kha_graphics4_PipelineState_compile(kha__graphics4__PipelineState);
extern String s$projectionMatrix;
vvirtual* kha_graphics4_PipelineState_getConstantLocation(kha__graphics4__PipelineState,String);
haxe__Exception haxe_Exception_caught(vdynamic*);
extern haxe__$Log g$_haxe_Log;
extern hl_type t$vrt_329ffa8;
extern String s$kha_graphics4_Graphics2_hx;
extern hl_type t$String;
extern hl_type t$_i32;
extern String s$d9cb131;
extern String s$new;
extern hl_type t$vrt_eaa6a3b;
extern String s$tex;
vvirtual* kha_graphics4_PipelineState_getTextureUnit(kha__graphics4__PipelineState,String);
void kha_graphics4_InternalPipeline_new(kha__graphics4__InternalPipeline,kha__graphics4__PipelineState,vvirtual*,vvirtual*);
int hl_types_ArrayObj_push(hl__types__ArrayObj,vdynamic*);

kha__graphics4__InternalPipeline kha_graphics4_PerFramebufferPipelineCache_get(kha__graphics4__PerFramebufferPipelineCache r0,hl__types__ArrayBytes_Int r1,int r2) {
	hl__types__ArrayObj r3;
	kha__graphics4__InternalPipeline r6;
	vdynamic *r7;
	varray *r8;
	int r4, r5;
	r3 = r0->pipelines;
	if( r3 == NULL ) hl_null_access();
	r4 = kha_graphics4_PerFramebufferPipelineCache_hash(r0,r1,r2);
	r5 = r3->length;
	if( ((unsigned)r4) < ((unsigned)r5) ) goto label$a2ae7e4_1_7;
	r6 = NULL;
	goto label$a2ae7e4_1_10;
	label$a2ae7e4_1_7:
	r8 = r3->array;
	r7 = ((vdynamic**)(r8 + 1))[r4];
	r6 = (kha__graphics4__InternalPipeline)r7;
	label$a2ae7e4_1_10:
	return r6;
}

int kha_graphics4_PerFramebufferPipelineCache_hash(kha__graphics4__PerFramebufferPipelineCache r0,hl__types__ArrayBytes_Int r1,int r2) {
	int r3;
	r3 = 0;
	return r3;
}

void kha_graphics4_PerFramebufferPipelineCache_new(kha__graphics4__PerFramebufferPipelineCache r0,kha__graphics4__PipelineState r1,bool r2) {
	String r11;
	vvirtual *r8, *r10, *r17, *r18, *r19;
	hl__types__ArrayObj r3;
	hl_type *r5;
	haxe__$Log r15;
	kha__graphics4__InternalPipeline r20;
	vclosure *r14;
	haxe__Exception r13;
	vdynamic *r9, *r12, *r16;
	int r6;
	varray *r4;
	hl_trap_ctx trap$0;
	r5 = &t$kha_graphics4_InternalPipeline;
	r6 = 0;
	r4 = hl_alloc_array(r5,r6);
	r3 = hl_types_ArrayObj_alloc(r4);
	r0->pipelines = r3;
	if( r1 == NULL ) hl_null_access();
	kha_graphics4_PipelineState_compile(r1);
	r8 = NULL;
	hl_trap(trap$0,r9,label$a2ae7e4_3_14);
	r11 = (String)s$projectionMatrix;
	r10 = kha_graphics4_PipelineState_getConstantLocation(r1,r11);
	r8 = r10;
	hl_endtrap(trap$0);
	goto label$a2ae7e4_3_31;
	label$a2ae7e4_3_14:
	r13 = haxe_Exception_caught(r9);
	if( r13 == NULL ) hl_null_access();
	r12 = ((vdynamic* (*)(haxe__Exception))r13->$type->vobj_proto[0])(r13);
	r15 = (haxe__$Log)g$_haxe_Log;
	r14 = r15->trace;
	if( r14 == NULL ) hl_null_access();
	r17 = hl_alloc_virtual(&t$vrt_329ffa8);
	r11 = (String)s$kha_graphics4_Graphics2_hx;
	if( hl_vfields(r17)[1] ) *(String*)(hl_vfields(r17)[1]) = (String)r11; else hl_dyn_setp(r17->value,37969014/*fileName*/,&t$String,r11);
	r6 = 89;
	if( hl_vfields(r17)[2] ) *(int*)(hl_vfields(r17)[2]) = (int)r6; else hl_dyn_seti(r17->value,371360620/*lineNumber*/,&t$_i32,r6);
	r11 = (String)s$d9cb131;
	if( hl_vfields(r17)[0] ) *(String*)(hl_vfields(r17)[0]) = (String)r11; else hl_dyn_setp(r17->value,-63073762/*className*/,&t$String,r11);
	r11 = (String)s$new;
	if( hl_vfields(r17)[3] ) *(String*)(hl_vfields(r17)[3]) = (String)r11; else hl_dyn_setp(r17->value,302979532/*methodName*/,&t$String,r11);
	r18 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r17);
	r14->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r14->fun)((vdynamic*)r14->value,r12,r18) : ((void (*)(vdynamic*,vvirtual*))r14->fun)(r12,r18);
	label$a2ae7e4_3_31:
	r10 = NULL;
	if( !r2 ) goto label$a2ae7e4_3_56;
	hl_trap(trap$0,r12,label$a2ae7e4_3_39);
	r11 = (String)s$tex;
	r19 = kha_graphics4_PipelineState_getTextureUnit(r1,r11);
	r10 = r19;
	hl_endtrap(trap$0);
	goto label$a2ae7e4_3_56;
	label$a2ae7e4_3_39:
	r13 = haxe_Exception_caught(r12);
	if( r13 == NULL ) hl_null_access();
	r16 = ((vdynamic* (*)(haxe__Exception))r13->$type->vobj_proto[0])(r13);
	r15 = (haxe__$Log)g$_haxe_Log;
	r14 = r15->trace;
	if( r14 == NULL ) hl_null_access();
	r17 = hl_alloc_virtual(&t$vrt_329ffa8);
	r11 = (String)s$kha_graphics4_Graphics2_hx;
	if( hl_vfields(r17)[1] ) *(String*)(hl_vfields(r17)[1]) = (String)r11; else hl_dyn_setp(r17->value,37969014/*fileName*/,&t$String,r11);
	r6 = 98;
	if( hl_vfields(r17)[2] ) *(int*)(hl_vfields(r17)[2]) = (int)r6; else hl_dyn_seti(r17->value,371360620/*lineNumber*/,&t$_i32,r6);
	r11 = (String)s$d9cb131;
	if( hl_vfields(r17)[0] ) *(String*)(hl_vfields(r17)[0]) = (String)r11; else hl_dyn_setp(r17->value,-63073762/*className*/,&t$String,r11);
	r11 = (String)s$new;
	if( hl_vfields(r17)[3] ) *(String*)(hl_vfields(r17)[3]) = (String)r11; else hl_dyn_setp(r17->value,302979532/*methodName*/,&t$String,r11);
	r18 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r17);
	r14->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r14->fun)((vdynamic*)r14->value,r16,r18) : ((void (*)(vdynamic*,vvirtual*))r14->fun)(r16,r18);
	label$a2ae7e4_3_56:
	r3 = r0->pipelines;
	if( r3 == NULL ) hl_null_access();
	r20 = (kha__graphics4__InternalPipeline)hl_alloc_obj(&t$kha_graphics4_InternalPipeline);
	kha_graphics4_InternalPipeline_new(r20,r1,r8,r10);
	r6 = hl_types_ArrayObj_push(r3,((vdynamic*)r20));
	return;
}

