// Generated by HLC 4.1.3 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <kha/graphics4/TextShaderPainter.h>
extern kha__graphics4__$TextShaderPainter g$_kha_graphics4_TextShaderPainter;
#include <kha/graphics4/PerFramebufferPipelineCache.h>
kha__graphics4__VertexStructure kha_graphics4_Graphics2_createTextVertexStructure(void);
kha__graphics4__PipelineState kha_graphics4_Graphics2_createTextPipeline(kha__graphics4__VertexStructure);
extern hl_type t$kha_graphics4_PerFramebufferPipelineCache;
void kha_graphics4_PerFramebufferPipelineCache_new(kha__graphics4__PerFramebufferPipelineCache,kha__graphics4__PipelineState,bool);
extern hl_type t$vrt_39c470b;
#include <kha/arrays/Uint32ArrayPrivate.h>
extern hl_type t$kha_graphics4_VertexBuffer;
void kha_graphics4_VertexBuffer_new(kha__graphics4__VertexBuffer,int,kha__graphics4__VertexStructure,int,int*,bool*);
kha__arrays__Float32ArrayPrivate kha_graphics4_VertexBuffer_lock(kha__graphics4__VertexBuffer,vdynamic*,vdynamic*);
extern hl_type t$kha_graphics4_IndexBuffer;
void kha_graphics4_IndexBuffer_new(kha__graphics4__IndexBuffer,int,int,bool*);
kha__arrays__Uint32ArrayPrivate kha_graphics4_IndexBuffer_lock(kha__graphics4__IndexBuffer,vdynamic*,vdynamic*);
#include <hl/natives.h>
void kha_graphics4_IndexBuffer_unlock(kha__graphics4__IndexBuffer,vdynamic*);
extern hl_type t$_i32;
void kha_graphics4_VertexBuffer_unlock(kha__graphics4__VertexBuffer,vdynamic*);
extern hl_type t$fun_c881552;
extern hl_type t$fun_c80ec77;
extern hl_type t$fun_a561c62;
extern hl_type t$fun_46c6b6e;
extern hl_type t$fun_896f717;
extern hl_type t$fun_04e2896;
extern hl_type t$fun_4ad9aaa;
extern hl_type t$fun_8305be0;
void kha_graphics4_TextShaderPainter_end(kha__graphics4__TextShaderPainter);
#include <kha/graphics2/Graphics.h>
#include <kha/KravurImage.h>
extern kha__graphics2__$Graphics g$_kha_graphics2_Graphics;
extern kha__$KravurImage g$_kha_KravurImage;
kha__KravurImage kha_Kravur__get(kha__Kravur,int);
kha__Image kha_KravurImage_getTexture(kha__KravurImage);
kha__AlignedQuad kha_KravurImage_getBakedQuad(kha__KravurImage,kha__AlignedQuad,int,double,double);
int kha_Image_get_width(kha__Image);
int kha_Image_get_realWidth(kha__Image);
int kha_Image_get_height(kha__Image);
int kha_Image_get_realHeight(kha__Image);
extern hl_type t$kha_AlignedQuad;
void kha_AlignedQuad_new(kha__AlignedQuad);

vvirtual* kha_graphics4_TextShaderPainter_get_pipeline(kha__graphics4__TextShaderPainter r0) {
	vvirtual *r1;
	r1 = r0->myPipeline;
	return r1;
}

vvirtual* kha_graphics4_TextShaderPainter_set_pipeline(kha__graphics4__TextShaderPainter r0,vvirtual* r1) {
	kha__graphics4__$TextShaderPainter r3;
	vvirtual *r2;
	if( !r1 ) goto label$cb73abe_2_3;
	r2 = r1;
	goto label$cb73abe_2_5;
	label$cb73abe_2_3:
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r2 = r3->standardTextPipeline;
	label$cb73abe_2_5:
	r0->myPipeline = r2;
	r2 = r0->myPipeline;
	return r2;
}

void kha_graphics4_TextShaderPainter_setProjection(kha__graphics4__TextShaderPainter r0,kha__math__FastMatrix4 r1) {
	r0->projectionMatrix = r1;
	return;
}

void kha_graphics4_TextShaderPainter_initShaders() {
	kha__graphics4__PipelineState r4;
	kha__graphics4__$TextShaderPainter r2;
	vvirtual *r3;
	bool r6;
	kha__graphics4__PerFramebufferPipelineCache r5;
	kha__graphics4__VertexStructure r1;
	r2 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r1 = r2->structure;
	if( r1 ) goto label$cb73abe_4_6;
	r1 = kha_graphics4_Graphics2_createTextVertexStructure();
	r2 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r2->structure = r1;
	label$cb73abe_4_6:
	r2 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r3 = r2->standardTextPipeline;
	if( r3 ) goto label$cb73abe_4_24;
	r2 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r1 = r2->structure;
	r4 = kha_graphics4_Graphics2_createTextPipeline(r1);
	r5 = (kha__graphics4__PerFramebufferPipelineCache)hl_alloc_obj(&t$kha_graphics4_PerFramebufferPipelineCache);
	r6 = true;
	kha_graphics4_PerFramebufferPipelineCache_new(r5,r4,r6);
	if( r5 ) goto label$cb73abe_4_18;
	r3 = NULL;
	goto label$cb73abe_4_22;
	label$cb73abe_4_18:
	r3 = r5->f$1;
	if( r3 ) goto label$cb73abe_4_22;
	r3 = hl_to_virtual(&t$vrt_39c470b,(vdynamic*)r5);
	r5->f$1 = r3;
	label$cb73abe_4_22:
	r2 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r2->standardTextPipeline = r3;
	label$cb73abe_4_24:
	return;
}

void kha_graphics4_TextShaderPainter_initBuffers(kha__graphics4__TextShaderPainter r0) {
	bool *r8;
	kha__graphics4__$TextShaderPainter r3;
	kha__graphics4__VertexBuffer r2;
	kha__graphics4__IndexBuffer r12;
	kha__arrays__Float32ArrayPrivate r9;
	kha__arrays__Uint32ArrayPrivate r13;
	vdynamic *r10, *r11;
	int *r7;
	vbyte *r16;
	kha__graphics4__VertexStructure r5;
	int r4, r6, r14, r15, r17;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r2 = r3->rectVertexBuffer;
	if( r2 ) goto label$cb73abe_5_113;
	r2 = (kha__graphics4__VertexBuffer)hl_alloc_obj(&t$kha_graphics4_VertexBuffer);
	r4 = 4000;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r5 = r3->structure;
	r6 = 1;
	r7 = NULL;
	r8 = NULL;
	kha_graphics4_VertexBuffer_new(r2,r4,r5,r6,r7,r8);
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r3->rectVertexBuffer = r2;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r2 = r3->rectVertexBuffer;
	if( r2 == NULL ) hl_null_access();
	r10 = NULL;
	r11 = NULL;
	r9 = kha_graphics4_VertexBuffer_lock(r2,r10,r11);
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r3->rectVertices = r9;
	r12 = (kha__graphics4__IndexBuffer)hl_alloc_obj(&t$kha_graphics4_IndexBuffer);
	r4 = 6000;
	r6 = 0;
	r8 = NULL;
	kha_graphics4_IndexBuffer_new(r12,r4,r6,r8);
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r3->indexBuffer = r12;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r12 = r3->indexBuffer;
	if( r12 == NULL ) hl_null_access();
	r10 = NULL;
	r11 = NULL;
	r13 = kha_graphics4_IndexBuffer_lock(r12,r10,r11);
	r4 = 0;
	label$cb73abe_5_35:
	r14 = 1000;
	if( r4 >= r14 ) goto label$cb73abe_5_108;
	r6 = r4;
	++r4;
	r15 = 4;
	r14 = r6 * r15;
	if( r13 == NULL ) hl_null_access();
	r16 = r13->self;
	r17 = 3;
	r15 = r6 * r17;
	r17 = 2;
	r15 = r15 * r17;
	hl_kore_uint32array_set(r16,r15,r14);
	r15 = 4;
	r14 = r6 * r15;
	r15 = 1;
	r14 = r14 + r15;
	r16 = r13->self;
	r17 = 3;
	r15 = r6 * r17;
	r17 = 2;
	r15 = r15 * r17;
	r17 = 1;
	r15 = r15 + r17;
	hl_kore_uint32array_set(r16,r15,r14);
	r15 = 4;
	r14 = r6 * r15;
	r15 = 2;
	r14 = r14 + r15;
	r16 = r13->self;
	r17 = 3;
	r15 = r6 * r17;
	r17 = 2;
	r15 = r15 * r17;
	r17 = 2;
	r15 = r15 + r17;
	hl_kore_uint32array_set(r16,r15,r14);
	r15 = 4;
	r14 = r6 * r15;
	r16 = r13->self;
	r17 = 3;
	r15 = r6 * r17;
	r17 = 2;
	r15 = r15 * r17;
	r17 = 3;
	r15 = r15 + r17;
	hl_kore_uint32array_set(r16,r15,r14);
	r15 = 4;
	r14 = r6 * r15;
	r15 = 2;
	r14 = r14 + r15;
	r16 = r13->self;
	r17 = 3;
	r15 = r6 * r17;
	r17 = 2;
	r15 = r15 * r17;
	r17 = 4;
	r15 = r15 + r17;
	hl_kore_uint32array_set(r16,r15,r14);
	r15 = 4;
	r14 = r6 * r15;
	r15 = 3;
	r14 = r14 + r15;
	r16 = r13->self;
	r17 = 3;
	r15 = r6 * r17;
	r17 = 2;
	r15 = r15 * r17;
	r17 = 5;
	r15 = r15 + r17;
	hl_kore_uint32array_set(r16,r15,r14);
	goto label$cb73abe_5_35;
	label$cb73abe_5_108:
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r12 = r3->indexBuffer;
	if( r12 == NULL ) hl_null_access();
	r10 = NULL;
	kha_graphics4_IndexBuffer_unlock(r12,r10);
	label$cb73abe_5_113:
	return;
}

void kha_graphics4_TextShaderPainter_setRectVertices(kha__graphics4__TextShaderPainter r0,double r1,double r2,double r3,double r4,double r5,double r6,double r7,double r8) {
	kha__graphics4__$TextShaderPainter r10;
	float r16;
	kha__arrays__Float32ArrayPrivate r14;
	double r15;
	vbyte *r13;
	int r9, r11, r17;
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r9 = r10->bufferIndex;
	r11 = 9;
	r9 = r9 * r11;
	r11 = 4;
	r9 = r9 * r11;
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r16 = (float)r1;
	hl_kore_float32array_set(r13,r9,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 1;
	r11 = r9 + r17;
	r16 = (float)r2;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 2;
	r11 = r9 + r17;
	r15 = -5.;
	r16 = (float)r15;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 9;
	r11 = r9 + r17;
	r16 = (float)r3;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 10;
	r11 = r9 + r17;
	r16 = (float)r4;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 11;
	r11 = r9 + r17;
	r15 = -5.;
	r16 = (float)r15;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 18;
	r11 = r9 + r17;
	r16 = (float)r5;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 19;
	r11 = r9 + r17;
	r16 = (float)r6;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 20;
	r11 = r9 + r17;
	r15 = -5.;
	r16 = (float)r15;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 27;
	r11 = r9 + r17;
	r16 = (float)r7;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 28;
	r11 = r9 + r17;
	r16 = (float)r8;
	hl_kore_float32array_set(r13,r11,r16);
	r10 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r10->rectVertices;
	if( r14 == NULL ) hl_null_access();
	r13 = r14->self;
	r17 = 29;
	r11 = r9 + r17;
	r15 = -5.;
	r16 = (float)r15;
	hl_kore_float32array_set(r13,r11,r16);
	return;
}

void kha_graphics4_TextShaderPainter_setRectTexCoords(kha__graphics4__TextShaderPainter r0,double r1,double r2,double r3,double r4) {
	kha__graphics4__$TextShaderPainter r6;
	float r12;
	kha__arrays__Float32ArrayPrivate r10;
	vbyte *r9;
	int r5, r7, r11;
	r6 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r5 = r6->bufferIndex;
	r7 = 9;
	r5 = r5 * r7;
	r7 = 4;
	r5 = r5 * r7;
	r6 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r10 = r6->rectVertices;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->self;
	r11 = 3;
	r7 = r5 + r11;
	r12 = (float)r1;
	hl_kore_float32array_set(r9,r7,r12);
	r6 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r10 = r6->rectVertices;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->self;
	r11 = 4;
	r7 = r5 + r11;
	r12 = (float)r4;
	hl_kore_float32array_set(r9,r7,r12);
	r6 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r10 = r6->rectVertices;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->self;
	r11 = 12;
	r7 = r5 + r11;
	r12 = (float)r1;
	hl_kore_float32array_set(r9,r7,r12);
	r6 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r10 = r6->rectVertices;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->self;
	r11 = 13;
	r7 = r5 + r11;
	r12 = (float)r2;
	hl_kore_float32array_set(r9,r7,r12);
	r6 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r10 = r6->rectVertices;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->self;
	r11 = 21;
	r7 = r5 + r11;
	r12 = (float)r3;
	hl_kore_float32array_set(r9,r7,r12);
	r6 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r10 = r6->rectVertices;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->self;
	r11 = 22;
	r7 = r5 + r11;
	r12 = (float)r2;
	hl_kore_float32array_set(r9,r7,r12);
	r6 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r10 = r6->rectVertices;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->self;
	r11 = 30;
	r7 = r5 + r11;
	r12 = (float)r3;
	hl_kore_float32array_set(r9,r7,r12);
	r6 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r10 = r6->rectVertices;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->self;
	r11 = 31;
	r7 = r5 + r11;
	r12 = (float)r4;
	hl_kore_float32array_set(r9,r7,r12);
	return;
}

void kha_graphics4_TextShaderPainter_setRectColors(kha__graphics4__TextShaderPainter r0,float r1,int r2) {
	kha__graphics4__$TextShaderPainter r4;
	kha__arrays__Float32ArrayPrivate r13;
	float r7, r8, r11;
	double r10;
	vbyte *r12;
	int r3, r5, r9;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r3 = r4->bufferIndex;
	r5 = 9;
	r3 = r3 * r5;
	r5 = 4;
	r3 = r3 * r5;
	r9 = 24;
	r5 = ((unsigned)r2) >> r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r7 = r1 * r8;
	r9 = 16711680;
	r5 = r2 & r9;
	r9 = 16;
	r5 = ((unsigned)r5) >> r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 5;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r9 = 65280;
	r5 = r2 & r9;
	r9 = 8;
	r5 = ((unsigned)r5) >> r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 6;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r9 = 255;
	r5 = r2 & r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 7;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 8;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r7);
	r9 = 16711680;
	r5 = r2 & r9;
	r9 = 16;
	r5 = ((unsigned)r5) >> r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 14;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r9 = 65280;
	r5 = r2 & r9;
	r9 = 8;
	r5 = ((unsigned)r5) >> r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 15;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r9 = 255;
	r5 = r2 & r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 16;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 17;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r7);
	r9 = 16711680;
	r5 = r2 & r9;
	r9 = 16;
	r5 = ((unsigned)r5) >> r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 23;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r9 = 65280;
	r5 = r2 & r9;
	r9 = 8;
	r5 = ((unsigned)r5) >> r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 24;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r9 = 255;
	r5 = r2 & r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 25;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 26;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r7);
	r9 = 16711680;
	r5 = r2 & r9;
	r9 = 16;
	r5 = ((unsigned)r5) >> r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 32;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r9 = 65280;
	r5 = r2 & r9;
	r9 = 8;
	r5 = ((unsigned)r5) >> r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 33;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r9 = 255;
	r5 = r2 & r9;
	r8 = (float)r5;
	r10 = 0.003921568627450980338;
	r11 = (float)r10;
	r8 = r8 * r11;
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 34;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r8);
	r4 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13 = r4->rectVertices;
	if( r13 == NULL ) hl_null_access();
	r12 = r13->self;
	r9 = 35;
	r5 = r3 + r9;
	hl_kore_float32array_set(r12,r5,r7);
	return;
}

void kha_graphics4_TextShaderPainter_drawBuffer(kha__graphics4__TextShaderPainter r0) {
	kha__Image r15;
	kha__graphics4__PipelineState r11;
	kha__graphics4__$TextShaderPainter r3;
	vvirtual *r8, *r10, *r13;
	bool r17;
	kha__math__FastMatrix4 r14;
	hl__types__ArrayBytes_Int r9;
	kha__graphics4__VertexBuffer r5;
	kha__graphics4__IndexBuffer r12;
	kha__graphics4__InternalPipeline r7;
	kha__arrays__Float32ArrayPrivate r22;
	int *r20, *r21;
	vdynamic *r6, *r23;
	int r2, r4, r16, r18, r19;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r2 = r3->bufferIndex;
	r4 = 0;
	if( r2 != r4 ) goto label$cb73abe_9_5;
	return;
	label$cb73abe_9_5:
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r5 = r3->rectVertexBuffer;
	if( r5 == NULL ) hl_null_access();
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r2 = r3->bufferIndex;
	r4 = 4;
	r2 = r2 * r4;
	r6 = hl_alloc_dynamic(&t$_i32);
	r6->v.i = r2;
	kha_graphics4_VertexBuffer_unlock(r5,r6);
	r8 = r0->myPipeline;
	if( r8 == NULL ) hl_null_access();
	r9 = NULL;
	r2 = 3;
	if( hl_vfields(r8)[0] ) r7 = ((kha__graphics4__InternalPipeline (*)(vdynamic*,hl__types__ArrayBytes_Int,int))hl_vfields(r8)[0])(r8->value,r9,r2); else {
		void *args[] = {r9,&r2};
		r7 = (kha__graphics4__InternalPipeline)hl_dyn_call_obj(r8->value,&t$fun_c881552,5144726/*get*/,args,NULL);
	}
	r10 = r0->g;
	if( r10 == NULL ) hl_null_access();
	if( r7 == NULL ) hl_null_access();
	r11 = r7->pipeline;
	if( hl_vfields(r10)[15] ) ((void (*)(vdynamic*,kha__graphics4__PipelineState))hl_vfields(r10)[15])(r10->value,r11); else {
		void *args[] = {r11};
		hl_dyn_call_obj(r10->value,&t$fun_c80ec77,467961459/*setPipeline*/,args,NULL);
	}
	r10 = r0->g;
	if( r10 == NULL ) hl_null_access();
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r5 = r3->rectVertexBuffer;
	if( hl_vfields(r10)[4] ) ((void (*)(vdynamic*,kha__graphics4__VertexBuffer))hl_vfields(r10)[4])(r10->value,r5); else {
		void *args[] = {r5};
		hl_dyn_call_obj(r10->value,&t$fun_a561c62,-278953801/*setVertexBuffer*/,args,NULL);
	}
	r10 = r0->g;
	if( r10 == NULL ) hl_null_access();
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r12 = r3->indexBuffer;
	if( hl_vfields(r10)[23] ) ((void (*)(vdynamic*,kha__graphics4__IndexBuffer))hl_vfields(r10)[23])(r10->value,r12); else {
		void *args[] = {r12};
		hl_dyn_call_obj(r10->value,&t$fun_46c6b6e,-43737183/*setIndexBuffer*/,args,NULL);
	}
	r10 = r0->g;
	if( r10 == NULL ) hl_null_access();
	r13 = r7->projectionLocation;
	r14 = r0->projectionMatrix;
	if( hl_vfields(r10)[17] ) ((void (*)(vdynamic*,vvirtual*,kha__math__FastMatrix4))hl_vfields(r10)[17])(r10->value,r13,r14); else {
		void *args[] = {r13,r14};
		hl_dyn_call_obj(r10->value,&t$fun_896f717,460303235/*setMatrix*/,args,NULL);
	}
	r10 = r0->g;
	if( r10 == NULL ) hl_null_access();
	r13 = r7->textureLocation;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r15 = r3->lastTexture;
	if( hl_vfields(r10)[13] ) ((void (*)(vdynamic*,vvirtual*,kha__Image))hl_vfields(r10)[13])(r10->value,r13,r15); else {
		void *args[] = {r13,r15};
		hl_dyn_call_obj(r10->value,&t$fun_04e2896,-239080103/*setTexture*/,args,NULL);
	}
	r10 = r0->g;
	if( r10 == NULL ) hl_null_access();
	r13 = r7->textureLocation;
	r2 = 2;
	r4 = 2;
	r17 = r0->bilinear;
	if( !r17 ) goto label$cb73abe_9_54;
	r16 = 1;
	goto label$cb73abe_9_55;
	label$cb73abe_9_54:
	r16 = 0;
	label$cb73abe_9_55:
	r17 = r0->bilinear;
	if( !r17 ) goto label$cb73abe_9_59;
	r18 = 1;
	goto label$cb73abe_9_60;
	label$cb73abe_9_59:
	r18 = 0;
	label$cb73abe_9_60:
	r19 = 0;
	if( hl_vfields(r10)[8] ) ((void (*)(vdynamic*,vvirtual*,int,int,int,int,int))hl_vfields(r10)[8])(r10->value,r13,r2,r4,r16,r18,r19); else {
		void *args[] = {r13,&r2,&r4,&r16,&r18,&r19};
		hl_dyn_call_obj(r10->value,&t$fun_4ad9aaa,357382632/*setTextureParameters*/,args,NULL);
	}
	r10 = r0->g;
	if( r10 == NULL ) hl_null_access();
	r2 = 0;
	r20 = &r2;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r4 = r3->bufferIndex;
	r16 = 2;
	r4 = r4 * r16;
	r16 = 3;
	r4 = r4 * r16;
	r21 = &r4;
	if( hl_vfields(r10)[41] ) ((void (*)(vdynamic*,int*,int*))hl_vfields(r10)[41])(r10->value,r20,r21); else {
		void *args[] = {r20,r21};
		hl_dyn_call_obj(r10->value,&t$fun_8305be0,-519327652/*drawIndexedVertices*/,args,NULL);
	}
	r10 = r0->g;
	if( r10 == NULL ) hl_null_access();
	r13 = r7->textureLocation;
	r15 = NULL;
	if( hl_vfields(r10)[13] ) ((void (*)(vdynamic*,vvirtual*,kha__Image))hl_vfields(r10)[13])(r10->value,r13,r15); else {
		void *args[] = {r13,r15};
		hl_dyn_call_obj(r10->value,&t$fun_04e2896,-239080103/*setTexture*/,args,NULL);
	}
	r16 = 0;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r3->bufferIndex = r16;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r5 = r3->rectVertexBuffer;
	if( r5 == NULL ) hl_null_access();
	r6 = NULL;
	r23 = NULL;
	r22 = kha_graphics4_VertexBuffer_lock(r5,r6,r23);
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r3->rectVertices = r22;
	return;
}

void kha_graphics4_TextShaderPainter_setBilinearFilter(kha__graphics4__TextShaderPainter r0,bool r1) {
	kha_graphics4_TextShaderPainter_end(r0);
	r0->bilinear = r1;
	return;
}

void kha_graphics4_TextShaderPainter_setFont(kha__graphics4__TextShaderPainter r0,kha__Kravur r1) {
	r0->font = r1;
	return;
}

int kha_graphics4_TextShaderPainter_findIndex(int r0) {
	kha__$KravurImage r4;
	hl__types__ArrayBytes_Int r1, r3;
	kha__graphics2__$Graphics r2;
	double r7, r9;
	vbyte *r13;
	int r5, r6, r8, r10, r11, r12, r14, r15, r16;
	r2 = (kha__graphics2__$Graphics)g$_kha_graphics2_Graphics;
	r1 = r2->fontGlyphs;
	r4 = (kha__$KravurImage)g$_kha_KravurImage;
	r3 = r4->charBlocks;
	r5 = 0;
	r6 = 0;
	if( r3 == NULL ) hl_null_access();
	r8 = r3->length;
	r7 = (double)r8;
	r9 = 2.;
	r7 = r7 / r9;
	r8 = (int)r7;
	label$cb73abe_12_12:
	if( r6 >= r8 ) goto label$cb73abe_12_50;
	r10 = r6;
	++r6;
	if( r3 == NULL ) hl_null_access();
	r12 = 2;
	r11 = r10 * r12;
	r12 = r3->length;
	if( ((unsigned)r11) < ((unsigned)r12) ) goto label$cb73abe_12_23;
	r11 = 0;
	goto label$cb73abe_12_27;
	label$cb73abe_12_23:
	r13 = r3->bytes;
	r12 = 2;
	r12 = r11 << r12;
	r11 = *(int*)(r13 + r12);
	label$cb73abe_12_27:
	r14 = 2;
	r12 = r10 * r14;
	r14 = 1;
	r12 = r12 + r14;
	r14 = r3->length;
	if( ((unsigned)r12) < ((unsigned)r14) ) goto label$cb73abe_12_35;
	r12 = 0;
	goto label$cb73abe_12_39;
	label$cb73abe_12_35:
	r13 = r3->bytes;
	r14 = 2;
	r14 = r12 << r14;
	r12 = *(int*)(r13 + r14);
	label$cb73abe_12_39:
	if( r0 < r11 ) goto label$cb73abe_12_44;
	if( r12 < r0 ) goto label$cb73abe_12_44;
	r14 = r5 + r0;
	r14 = r14 - r11;
	return r14;
	label$cb73abe_12_44:
	r15 = r12 - r11;
	r16 = 1;
	r15 = r15 + r16;
	r14 = r5 + r15;
	r5 = r14;
	goto label$cb73abe_12_12;
	label$cb73abe_12_50:
	r6 = 0;
	return r6;
}

void kha_graphics4_TextShaderPainter_drawString(kha__graphics4__TextShaderPainter r0,String r1,float r2,int r3,double r4,double r5,kha__math__FastMatrix3 r6) {
	kha__graphics4__$TextShaderPainter r13;
	kha__Image r11, r12, r14;
	kha__AlignedQuad r22;
	kha__Kravur r8;
	kha__KravurImage r7;
	float r26, r30, r31, r32, r33, r34, r35, r36, r37, r38, r39, r40, r41, r42, r43, r44, r45, r46, r47, r48;
	double r15, r16, r23, r24, r27, r28, r29, r49, r50, r51, r52, r53, r54, r55;
	vbyte *r20;
	int r9, r17, r18, r19, r21, r25;
	r8 = r0->font;
	if( r8 == NULL ) hl_null_access();
	r9 = r0->fontSize;
	r7 = kha_Kravur__get(r8,r9);
	if( r7 == NULL ) hl_null_access();
	r11 = kha_KravurImage_getTexture(r7);
	r13 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r12 = r13->lastTexture;
	if( !r12 ) goto label$cb73abe_13_13;
	r13 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r13->lastTexture;
	if( r11 == r14 ) goto label$cb73abe_13_13;
	kha_graphics4_TextShaderPainter_drawBuffer(r0);
	label$cb73abe_13_13:
	r13 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r13->lastTexture = r11;
	r15 = r4;
	r16 = r5;
	r9 = 0;
	if( r1 == NULL ) hl_null_access();
	r17 = r1->length;
	label$cb73abe_13_20:
	if( r9 >= r17 ) goto label$cb73abe_13_223;
	r18 = r9;
	++r9;
	if( r1 == NULL ) hl_null_access();
	r20 = r1->bytes;
	r21 = 1;
	r19 = r18 << r21;
	r19 = *(unsigned short*)(r20 + r19);
	if( r7 == NULL ) hl_null_access();
	r22 = r0->bakedQuadCache;
	r21 = kha_graphics4_TextShaderPainter_findIndex(r19);
	r22 = kha_KravurImage_getBakedQuad(r7,r22,r21,r15,r16);
	if( !r22 ) goto label$cb73abe_13_222;
	r13 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r21 = r13->bufferIndex;
	r25 = 1;
	r21 = r21 + r25;
	r25 = 1000;
	if( r21 < r25 ) goto label$cb73abe_13_41;
	kha_graphics4_TextShaderPainter_drawBuffer(r0);
	label$cb73abe_13_41:
	kha_graphics4_TextShaderPainter_setRectColors(r0,r2,r3);
	if( r22 == NULL ) hl_null_access();
	r23 = r22->s0;
	if( r11 == NULL ) hl_null_access();
	r21 = kha_Image_get_width(r11);
	r24 = (double)r21;
	r23 = r23 * r24;
	r21 = kha_Image_get_realWidth(r11);
	r24 = (double)r21;
	r23 = r23 / r24;
	r24 = r22->t0;
	r21 = kha_Image_get_height(r11);
	r27 = (double)r21;
	r24 = r24 * r27;
	r21 = kha_Image_get_realHeight(r11);
	r27 = (double)r21;
	r24 = r24 / r27;
	r27 = r22->s1;
	r21 = kha_Image_get_width(r11);
	r28 = (double)r21;
	r27 = r27 * r28;
	r21 = kha_Image_get_realWidth(r11);
	r28 = (double)r21;
	r27 = r27 / r28;
	r28 = r22->t1;
	r21 = kha_Image_get_height(r11);
	r29 = (double)r21;
	r28 = r28 * r29;
	r21 = kha_Image_get_realHeight(r11);
	r29 = (double)r21;
	r28 = r28 / r29;
	kha_graphics4_TextShaderPainter_setRectTexCoords(r0,r23,r24,r27,r28);
	r23 = r22->x0;
	r26 = (float)r23;
	r23 = r22->y1;
	r30 = (float)r23;
	if( r6 == NULL ) hl_null_access();
	r31 = r6->_02;
	r31 = r31 * r26;
	r32 = r6->_12;
	r32 = r32 * r30;
	r31 = r31 + r32;
	r32 = r6->_22;
	r31 = r31 + r32;
	r32 = r6->_00;
	r32 = r32 * r26;
	r33 = r6->_10;
	r33 = r33 * r30;
	r32 = r32 + r33;
	r33 = r6->_20;
	r32 = r32 + r33;
	r23 = (double)r32;
	r24 = (double)r31;
	r23 = r23 / r24;
	r32 = r6->_01;
	r32 = r32 * r26;
	r33 = r6->_11;
	r33 = r33 * r30;
	r32 = r32 + r33;
	r33 = r6->_21;
	r32 = r32 + r33;
	r24 = (double)r32;
	r27 = (double)r31;
	r24 = r24 / r27;
	r32 = (float)r24;
	r33 = (float)r23;
	r24 = r22->x0;
	r34 = (float)r24;
	r24 = r22->y0;
	r35 = (float)r24;
	r36 = r6->_02;
	r36 = r36 * r34;
	r37 = r6->_12;
	r37 = r37 * r35;
	r36 = r36 + r37;
	r37 = r6->_22;
	r36 = r36 + r37;
	r37 = r6->_00;
	r37 = r37 * r34;
	r38 = r6->_10;
	r38 = r38 * r35;
	r37 = r37 + r38;
	r38 = r6->_20;
	r37 = r37 + r38;
	r24 = (double)r37;
	r27 = (double)r36;
	r24 = r24 / r27;
	r37 = r6->_01;
	r37 = r37 * r34;
	r38 = r6->_11;
	r38 = r38 * r35;
	r37 = r37 + r38;
	r38 = r6->_21;
	r37 = r37 + r38;
	r27 = (double)r37;
	r28 = (double)r36;
	r27 = r27 / r28;
	r37 = (float)r27;
	r38 = (float)r24;
	r27 = r22->x1;
	r39 = (float)r27;
	r27 = r22->y0;
	r40 = (float)r27;
	r41 = r6->_02;
	r41 = r41 * r39;
	r42 = r6->_12;
	r42 = r42 * r40;
	r41 = r41 + r42;
	r42 = r6->_22;
	r41 = r41 + r42;
	r42 = r6->_00;
	r42 = r42 * r39;
	r43 = r6->_10;
	r43 = r43 * r40;
	r42 = r42 + r43;
	r43 = r6->_20;
	r42 = r42 + r43;
	r27 = (double)r42;
	r28 = (double)r41;
	r27 = r27 / r28;
	r42 = r6->_01;
	r42 = r42 * r39;
	r43 = r6->_11;
	r43 = r43 * r40;
	r42 = r42 + r43;
	r43 = r6->_21;
	r42 = r42 + r43;
	r28 = (double)r42;
	r29 = (double)r41;
	r28 = r28 / r29;
	r42 = (float)r28;
	r43 = (float)r27;
	r28 = r22->x1;
	r44 = (float)r28;
	r28 = r22->y1;
	r45 = (float)r28;
	r46 = r6->_02;
	r46 = r46 * r44;
	r47 = r6->_12;
	r47 = r47 * r45;
	r46 = r46 + r47;
	r47 = r6->_22;
	r46 = r46 + r47;
	r47 = r6->_00;
	r47 = r47 * r44;
	r48 = r6->_10;
	r48 = r48 * r45;
	r47 = r47 + r48;
	r48 = r6->_20;
	r47 = r47 + r48;
	r28 = (double)r47;
	r29 = (double)r46;
	r28 = r28 / r29;
	r47 = r6->_01;
	r47 = r47 * r44;
	r48 = r6->_11;
	r48 = r48 * r45;
	r47 = r47 + r48;
	r48 = r6->_21;
	r47 = r47 + r48;
	r29 = (double)r47;
	r49 = (double)r46;
	r29 = r29 / r49;
	r47 = (float)r29;
	r48 = (float)r28;
	r29 = (double)r33;
	r49 = (double)r32;
	r50 = (double)r38;
	r51 = (double)r37;
	r52 = (double)r43;
	r53 = (double)r42;
	r54 = (double)r48;
	r55 = (double)r47;
	kha_graphics4_TextShaderPainter_setRectVertices(r0,r29,r49,r50,r51,r52,r53,r54,r55);
	r49 = r22->xadvance;
	r29 = r15 + r49;
	r15 = r29;
	r13 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r21 = r13->bufferIndex;
	++r21;
	r13->bufferIndex = r21;
	label$cb73abe_13_222:
	goto label$cb73abe_13_20;
	label$cb73abe_13_223:
	return;
}

void kha_graphics4_TextShaderPainter_drawCharacters(kha__graphics4__TextShaderPainter r0,hl__types__ArrayBytes_Int r1,int r2,int r3,float r4,int r5,double r6,double r7,kha__math__FastMatrix3 r8) {
	kha__graphics4__$TextShaderPainter r15;
	kha__Image r13, r14, r16;
	kha__AlignedQuad r22;
	kha__Kravur r10;
	kha__KravurImage r9;
	float r27, r31, r32, r33, r34, r35, r36, r37, r38, r39, r40, r41, r42, r43, r44, r45, r46, r47, r48, r49;
	double r17, r18, r25, r26, r28, r29, r30, r50, r51, r52, r53, r54, r55, r56;
	vbyte *r24;
	int r11, r19, r20, r21, r23;
	r10 = r0->font;
	if( r10 == NULL ) hl_null_access();
	r11 = r0->fontSize;
	r9 = kha_Kravur__get(r10,r11);
	if( r9 == NULL ) hl_null_access();
	r13 = kha_KravurImage_getTexture(r9);
	r15 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r14 = r15->lastTexture;
	if( !r14 ) goto label$cb73abe_14_13;
	r15 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r16 = r15->lastTexture;
	if( r13 == r16 ) goto label$cb73abe_14_13;
	kha_graphics4_TextShaderPainter_drawBuffer(r0);
	label$cb73abe_14_13:
	r15 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r15->lastTexture = r13;
	r17 = r6;
	r18 = r7;
	r11 = r2;
	r19 = r2 + r3;
	label$cb73abe_14_19:
	if( r11 >= r19 ) goto label$cb73abe_14_226;
	r20 = r11;
	++r11;
	if( r9 == NULL ) hl_null_access();
	r22 = r0->bakedQuadCache;
	if( r1 == NULL ) hl_null_access();
	r23 = r1->length;
	if( ((unsigned)r20) < ((unsigned)r23) ) goto label$cb73abe_14_30;
	r21 = 0;
	goto label$cb73abe_14_34;
	label$cb73abe_14_30:
	r24 = r1->bytes;
	r23 = 2;
	r23 = r20 << r23;
	r21 = *(int*)(r24 + r23);
	label$cb73abe_14_34:
	r21 = kha_graphics4_TextShaderPainter_findIndex(r21);
	r22 = kha_KravurImage_getBakedQuad(r9,r22,r21,r17,r18);
	if( !r22 ) goto label$cb73abe_14_225;
	r15 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r21 = r15->bufferIndex;
	r23 = 1;
	r21 = r21 + r23;
	r23 = 1000;
	if( r21 < r23 ) goto label$cb73abe_14_44;
	kha_graphics4_TextShaderPainter_drawBuffer(r0);
	label$cb73abe_14_44:
	kha_graphics4_TextShaderPainter_setRectColors(r0,r4,r5);
	if( r22 == NULL ) hl_null_access();
	r25 = r22->s0;
	if( r13 == NULL ) hl_null_access();
	r21 = kha_Image_get_width(r13);
	r26 = (double)r21;
	r25 = r25 * r26;
	r21 = kha_Image_get_realWidth(r13);
	r26 = (double)r21;
	r25 = r25 / r26;
	r26 = r22->t0;
	r21 = kha_Image_get_height(r13);
	r28 = (double)r21;
	r26 = r26 * r28;
	r21 = kha_Image_get_realHeight(r13);
	r28 = (double)r21;
	r26 = r26 / r28;
	r28 = r22->s1;
	r21 = kha_Image_get_width(r13);
	r29 = (double)r21;
	r28 = r28 * r29;
	r21 = kha_Image_get_realWidth(r13);
	r29 = (double)r21;
	r28 = r28 / r29;
	r29 = r22->t1;
	r21 = kha_Image_get_height(r13);
	r30 = (double)r21;
	r29 = r29 * r30;
	r21 = kha_Image_get_realHeight(r13);
	r30 = (double)r21;
	r29 = r29 / r30;
	kha_graphics4_TextShaderPainter_setRectTexCoords(r0,r25,r26,r28,r29);
	r25 = r22->x0;
	r27 = (float)r25;
	r25 = r22->y1;
	r31 = (float)r25;
	if( r8 == NULL ) hl_null_access();
	r32 = r8->_02;
	r32 = r32 * r27;
	r33 = r8->_12;
	r33 = r33 * r31;
	r32 = r32 + r33;
	r33 = r8->_22;
	r32 = r32 + r33;
	r33 = r8->_00;
	r33 = r33 * r27;
	r34 = r8->_10;
	r34 = r34 * r31;
	r33 = r33 + r34;
	r34 = r8->_20;
	r33 = r33 + r34;
	r25 = (double)r33;
	r26 = (double)r32;
	r25 = r25 / r26;
	r33 = r8->_01;
	r33 = r33 * r27;
	r34 = r8->_11;
	r34 = r34 * r31;
	r33 = r33 + r34;
	r34 = r8->_21;
	r33 = r33 + r34;
	r26 = (double)r33;
	r28 = (double)r32;
	r26 = r26 / r28;
	r33 = (float)r26;
	r34 = (float)r25;
	r26 = r22->x0;
	r35 = (float)r26;
	r26 = r22->y0;
	r36 = (float)r26;
	r37 = r8->_02;
	r37 = r37 * r35;
	r38 = r8->_12;
	r38 = r38 * r36;
	r37 = r37 + r38;
	r38 = r8->_22;
	r37 = r37 + r38;
	r38 = r8->_00;
	r38 = r38 * r35;
	r39 = r8->_10;
	r39 = r39 * r36;
	r38 = r38 + r39;
	r39 = r8->_20;
	r38 = r38 + r39;
	r26 = (double)r38;
	r28 = (double)r37;
	r26 = r26 / r28;
	r38 = r8->_01;
	r38 = r38 * r35;
	r39 = r8->_11;
	r39 = r39 * r36;
	r38 = r38 + r39;
	r39 = r8->_21;
	r38 = r38 + r39;
	r28 = (double)r38;
	r29 = (double)r37;
	r28 = r28 / r29;
	r38 = (float)r28;
	r39 = (float)r26;
	r28 = r22->x1;
	r40 = (float)r28;
	r28 = r22->y0;
	r41 = (float)r28;
	r42 = r8->_02;
	r42 = r42 * r40;
	r43 = r8->_12;
	r43 = r43 * r41;
	r42 = r42 + r43;
	r43 = r8->_22;
	r42 = r42 + r43;
	r43 = r8->_00;
	r43 = r43 * r40;
	r44 = r8->_10;
	r44 = r44 * r41;
	r43 = r43 + r44;
	r44 = r8->_20;
	r43 = r43 + r44;
	r28 = (double)r43;
	r29 = (double)r42;
	r28 = r28 / r29;
	r43 = r8->_01;
	r43 = r43 * r40;
	r44 = r8->_11;
	r44 = r44 * r41;
	r43 = r43 + r44;
	r44 = r8->_21;
	r43 = r43 + r44;
	r29 = (double)r43;
	r30 = (double)r42;
	r29 = r29 / r30;
	r43 = (float)r29;
	r44 = (float)r28;
	r29 = r22->x1;
	r45 = (float)r29;
	r29 = r22->y1;
	r46 = (float)r29;
	r47 = r8->_02;
	r47 = r47 * r45;
	r48 = r8->_12;
	r48 = r48 * r46;
	r47 = r47 + r48;
	r48 = r8->_22;
	r47 = r47 + r48;
	r48 = r8->_00;
	r48 = r48 * r45;
	r49 = r8->_10;
	r49 = r49 * r46;
	r48 = r48 + r49;
	r49 = r8->_20;
	r48 = r48 + r49;
	r29 = (double)r48;
	r30 = (double)r47;
	r29 = r29 / r30;
	r48 = r8->_01;
	r48 = r48 * r45;
	r49 = r8->_11;
	r49 = r49 * r46;
	r48 = r48 + r49;
	r49 = r8->_21;
	r48 = r48 + r49;
	r30 = (double)r48;
	r50 = (double)r47;
	r30 = r30 / r50;
	r48 = (float)r30;
	r49 = (float)r29;
	r30 = (double)r34;
	r50 = (double)r33;
	r51 = (double)r39;
	r52 = (double)r38;
	r53 = (double)r44;
	r54 = (double)r43;
	r55 = (double)r49;
	r56 = (double)r48;
	kha_graphics4_TextShaderPainter_setRectVertices(r0,r30,r50,r51,r52,r53,r54,r55,r56);
	r50 = r22->xadvance;
	r30 = r17 + r50;
	r17 = r30;
	r15 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r21 = r15->bufferIndex;
	++r21;
	r15->bufferIndex = r21;
	label$cb73abe_14_225:
	goto label$cb73abe_14_19;
	label$cb73abe_14_226:
	return;
}

void kha_graphics4_TextShaderPainter_end(kha__graphics4__TextShaderPainter r0) {
	kha__Image r5;
	kha__graphics4__$TextShaderPainter r3;
	int r2, r4;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r2 = r3->bufferIndex;
	r4 = 0;
	if( r4 >= r2 ) goto label$cb73abe_15_5;
	kha_graphics4_TextShaderPainter_drawBuffer(r0);
	label$cb73abe_15_5:
	r5 = NULL;
	r3 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r3->lastTexture = r5;
	return;
}

void kha_graphics4_TextShaderPainter_new(kha__graphics4__TextShaderPainter r0,vvirtual* r1) {
	kha__graphics4__$TextShaderPainter r7;
	vvirtual *r5;
	kha__AlignedQuad r2;
	bool r4;
	int r6;
	r2 = (kha__AlignedQuad)hl_alloc_obj(&t$kha_AlignedQuad);
	kha_AlignedQuad_new(r2);
	r0->bakedQuadCache = r2;
	r4 = false;
	r0->bilinear = r4;
	r5 = NULL;
	r0->myPipeline = r5;
	r0->g = r1;
	r6 = 0;
	r7 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r7->bufferIndex = r6;
	kha_graphics4_TextShaderPainter_initShaders();
	r7 = (kha__graphics4__$TextShaderPainter)g$_kha_graphics4_TextShaderPainter;
	r5 = r7->standardTextPipeline;
	r0->myPipeline = r5;
	kha_graphics4_TextShaderPainter_initBuffers(r0);
	return;
}

