// Generated by HLC 4.1.3 (HL v4)
#define HLC_BOOT
#include <hlc.h>
#include <kha/netsync/Session.h>
extern kha__netsync__$Session g$_kha_netsync_Session;
extern hl_type t$fun_4dc72d5;
void haxe_ds_IntMap_set(haxe__ds__IntMap,int,vdynamic*);
#include <kha/netsync/Controller.h>
#include <hl/types/ArrayDyn.h>
#include <haxe/Log.h>
extern haxe__$Log g$_haxe_Log;
extern String s$Adding_controller_id_;
int kha_netsync_Controller__id(kha__netsync__Controller);
#include <hl/natives.h>
String String___alloc__(vbyte*,int);
String String___add__(String,String);
extern hl_type t$vrt_329ffa8;
extern String s$kha_netsync_Session_hx;
extern hl_type t$String;
extern hl_type t$_i32;
extern String s$kha_netsync_Session;
extern String s$addController;
extern hl_type t$vrt_eaa6a3b;
bool haxe_ds_IntMap_exists(haxe__ds__IntMap,int);
vdynamic* haxe_ds_IntMap_get(haxe__ds__IntMap,int);
haxe__io__Bytes haxe_io_Bytes_alloc(int);
void haxe_io_Bytes_blit(haxe__io__Bytes,int,haxe__io__Bytes,int,int);
void haxe_io_Bytes_setInt32(haxe__io__Bytes,int,int);
void haxe_io_Bytes_set(haxe__io__Bytes,int,int);
double kha_Scheduler_realTime(void);
void haxe_io_Bytes_setFloat(haxe__io__Bytes,int,double);
void kha_netsync_Session_sendToServer(kha__netsync__Session,haxe__io__Bytes);
#include <kha/netsync/LocalClient.h>
int haxe_io_Bytes_get(haxe__io__Bytes,int);
extern hl_type t$kha_netsync_LocalClient;
void kha_netsync_LocalClient_new(kha__netsync__LocalClient,int);
extern hl_type t$vrt_47d765d;
void kha_Scheduler_resetTime(void);
double haxe_io_Bytes_getDouble(haxe__io__Bytes,int);
vvirtual* haxe_ds_IntMap_iterator(haxe__ds__IntMap);
extern hl_type t$vrt_4adc768;
extern hl_type t$fun_bf7849e;
extern hl_type t$fun_5150610;
extern hl_type t$fun_cac02b9;
void kha_Scheduler_warp(double);
void kha_netsync_Session_executeRPC(kha__netsync__Session,haxe__io__Bytes);
double haxe_io_Bytes_getFloat(haxe__io__Bytes,int);
int haxe_io_Bytes_getInt32(haxe__io__Bytes,int);
#include <kha/netsync/SyncBuilder.h>
extern hl_type t$hl_types_ArrayDyn;
void hl_types_ArrayDyn_new(hl__types__ArrayDyn);
extern String s$;
String String_fromCharCode(int);
extern String s$Unknown_argument_type_;
extern String s$executeRPC;
extern String s$Bool_;
String Std_string(vdynamic*);
int hl_types_ArrayDyn_push(hl__types__ArrayDyn,vdynamic*);
extern String s$Float_;
extern hl_type t$_f64;
extern String s$Int_;
extern String s$String_;
hl__Class Type_resolveClass(String);
extern String s$_remotely;
vdynamic* Reflect_field(vdynamic*,String);
vdynamic* Reflect_callMethod(vdynamic*,vdynamic*,hl__types__ArrayDyn);
extern kha__netsync__$SyncBuilder g$_kha_netsync_SyncBuilder;
void kha_netsync_Session_reset(kha__netsync__Session);
extern hl_type t$kha_netsync_Network;
extern hl_type t$ctx_33ddeca;
extern hl_type t$fun_2827253;
void kha_netsync_Network_new(kha__netsync__Network,String,int,vclosure*,vclosure*);
extern hl_type t$fun_8c19b3d;
void kha_netsync_Network_listen(kha__netsync__Network,vclosure*);
void kha_netsync_Session_update(kha__netsync__Session);
extern hl_type t$fun_35dbd9b;
int kha_Scheduler_addFrameTask(vclosure*,int);
int kha_Scheduler_addTimeTask(vclosure*,double,double*,double*);
void kha_Scheduler_removeFrameTask(int);
void kha_Scheduler_removeTimeTask(int);
extern hl_type t$haxe_ds_IntMap;
void haxe_ds_IntMap_new(haxe__ds__IntMap);
extern hl_type t$vrt_088a3ef;
extern hl_type t$fun_7ea0805;
double kha_Scheduler_time(void);
void haxe_io_Bytes_setDouble(haxe__io__Bytes,int,double);
int kha_System_windowWidth(int*);
int kha_System_windowHeight(int*);
void kha_netsync_Network_send(kha__netsync__Network,haxe__io__Bytes,bool);

vvirtual* kha_netsync_Session_get_me(kha__netsync__Session r0) {
	vvirtual *r1;
	r1 = r0->localClient;
	return r1;
}

kha__netsync__Session kha_netsync_Session_the() {
	kha__netsync__$Session r1;
	kha__netsync__Session r0;
	r1 = (kha__netsync__$Session)g$_kha_netsync_Session;
	r0 = r1->instance;
	return r0;
}

void kha_netsync_Session_addEntity(kha__netsync__Session r0,vvirtual* r1) {
	haxe__ds__IntMap r3;
	int r4;
	r3 = r0->entities;
	if( r3 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	if( hl_vfields(r1)[3] ) r4 = ((int (*)(vdynamic*))hl_vfields(r1)[3])(r1->value); else {
		vdynamic ret;
		hl_dyn_call_obj(r1->value,&t$fun_4dc72d5,4747770/*_id*/,NULL,&ret);
		r4 = (int)ret.v.i;
	}
	haxe_ds_IntMap_set(r3,r4,((vdynamic*)r1));
	return;
}

void kha_netsync_Session_addController(kha__netsync__Session r0,kha__netsync__Controller r1) {
	String r5, r9;
	vvirtual *r10, *r11;
	haxe__ds__IntMap r12;
	haxe__$Log r4;
	vclosure *r3;
	int *r7;
	vbyte *r8;
	int r6;
	r4 = (haxe__$Log)g$_haxe_Log;
	r3 = r4->trace;
	if( r3 == NULL ) hl_null_access();
	r5 = (String)s$Adding_controller_id_;
	if( r1 == NULL ) hl_null_access();
	r6 = kha_netsync_Controller__id(r1);
	r7 = &r6;
	r8 = hl_itos(r6,r7);
	r9 = String___alloc__(r8,r6);
	r5 = String___add__(r5,r9);
	r10 = hl_alloc_virtual(&t$vrt_329ffa8);
	r9 = (String)s$kha_netsync_Session_hx;
	if( hl_vfields(r10)[1] ) *(String*)(hl_vfields(r10)[1]) = (String)r9; else hl_dyn_setp(r10->value,37969014/*fileName*/,&t$String,r9);
	r6 = 88;
	if( hl_vfields(r10)[2] ) *(int*)(hl_vfields(r10)[2]) = (int)r6; else hl_dyn_seti(r10->value,371360620/*lineNumber*/,&t$_i32,r6);
	r9 = (String)s$kha_netsync_Session;
	if( hl_vfields(r10)[0] ) *(String*)(hl_vfields(r10)[0]) = (String)r9; else hl_dyn_setp(r10->value,-63073762/*className*/,&t$String,r9);
	r9 = (String)s$addController;
	if( hl_vfields(r10)[3] ) *(String*)(hl_vfields(r10)[3]) = (String)r9; else hl_dyn_setp(r10->value,302979532/*methodName*/,&t$String,r9);
	r11 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r10);
	r3->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r3->fun)((vdynamic*)r3->value,((vdynamic*)r5),r11) : ((void (*)(vdynamic*,vvirtual*))r3->fun)(((vdynamic*)r5),r11);
	r6 = 0;
	r1->_inputBufferIndex = r6;
	r12 = r0->controllers;
	if( r12 == NULL ) hl_null_access();
	r6 = kha_netsync_Controller__id(r1);
	haxe_ds_IntMap_set(r12,r6,((vdynamic*)r1));
	return;
}

void kha_netsync_Session_sendControllerUpdate(kha__netsync__Session r0,int r1,haxe__io__Bytes r2) {
	haxe__io__Bytes r7, r12;
	bool r4;
	haxe__ds__IntMap r5;
	kha__netsync__Controller r9;
	vdynamic *r8;
	int r6, r10, r11;
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r4 = haxe_ds_IntMap_exists(r5,r1);
	if( !r4 ) goto label$8f13fe2_5_101;
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r7 = r9->_inputBuffer;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->length;
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r10 = r9->_inputBufferIndex;
	r11 = 4;
	r10 = r10 + r11;
	if( r2 == NULL ) hl_null_access();
	r11 = r2->length;
	r10 = r10 + r11;
	if( r6 >= r10 ) goto label$8f13fe2_5_57;
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r6 = r9->_inputBufferIndex;
	r10 = 4;
	r6 = r6 + r10;
	r10 = r2->length;
	r6 = r6 + r10;
	r7 = haxe_io_Bytes_alloc(r6);
	if( r7 == NULL ) hl_null_access();
	r6 = 0;
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r12 = r9->_inputBuffer;
	r10 = 0;
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r11 = r9->_inputBufferIndex;
	haxe_io_Bytes_blit(r7,r6,r12,r10,r11);
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r9->_inputBuffer = r7;
	label$8f13fe2_5_57:
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r7 = r9->_inputBuffer;
	if( r7 == NULL ) hl_null_access();
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r6 = r9->_inputBufferIndex;
	r10 = r2->length;
	haxe_io_Bytes_setInt32(r7,r6,r10);
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r7 = r9->_inputBuffer;
	if( r7 == NULL ) hl_null_access();
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r6 = r9->_inputBufferIndex;
	r10 = 4;
	r6 = r6 + r10;
	r10 = 0;
	r11 = r2->length;
	haxe_io_Bytes_blit(r7,r6,r2,r10,r11);
	r5 = r0->controllers;
	if( r5 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_get(r5,r1);
	r9 = (kha__netsync__Controller)r8;
	if( r9 == NULL ) hl_null_access();
	r6 = r9->_inputBufferIndex;
	r10 = 4;
	r11 = r2->length;
	r10 = r10 + r11;
	r6 = r6 + r10;
	r9->_inputBufferIndex = r6;
	label$8f13fe2_5_101:
	return;
}

void kha_netsync_Session_sendPing(kha__netsync__Session r0) {
	haxe__io__Bytes r1;
	double r5;
	int r2, r4;
	r2 = 5;
	r1 = haxe_io_Bytes_alloc(r2);
	if( r1 == NULL ) hl_null_access();
	r2 = 0;
	r4 = 4;
	haxe_io_Bytes_set(r1,r2,r4);
	r2 = 1;
	r5 = kha_Scheduler_realTime();
	haxe_io_Bytes_setFloat(r1,r2,r5);
	kha_netsync_Session_sendToServer(r0,r1);
	return;
}

void kha_netsync_Session_sendPlayerUpdate(kha__netsync__Session r0) {
	return;
}

void kha_netsync_Session_receive(kha__netsync__Session r0,haxe__io__Bytes r1,vvirtual* r2) {
	vvirtual *r7, *r10, *r12, *r14;
	bool r13;
	haxe__ds__IntMap r11;
	double r9, r16;
	vclosure *r8;
	kha__netsync__LocalClient r5;
	int r4, r6, r15;
	if( r1 == NULL ) hl_null_access();
	r4 = 0;
	r4 = haxe_io_Bytes_get(r1,r4);
	switch(r4) {
		default:
		case 2:
			goto label$8f13fe2_8_62;
		case 0:
			r4 = 1;
			r4 = haxe_io_Bytes_get(r1,r4);
			r5 = (kha__netsync__LocalClient)hl_alloc_obj(&t$kha_netsync_LocalClient);
			kha_netsync_LocalClient_new(r5,r4);
			if( r5 ) goto label$8f13fe2_8_12;
			r7 = NULL;
			goto label$8f13fe2_8_16;
			label$8f13fe2_8_12:
			r7 = r5->f$3;
			if( r7 ) goto label$8f13fe2_8_16;
			r7 = hl_to_virtual(&t$vrt_47d765d,(vdynamic*)r5);
			r5->f$3 = r7;
			label$8f13fe2_8_16:
			r0->localClient = r7;
			kha_Scheduler_resetTime();
			r8 = r0->startCallback;
			if( r8 == NULL ) hl_null_access();
			r8->hasValue ? ((void (*)(vdynamic*))r8->fun)((vdynamic*)r8->value) : ((void (*)(void))r8->fun)();
			goto label$8f13fe2_8_62;
		case 1:
			r4 = 1;
			r9 = haxe_io_Bytes_getDouble(r1,r4);
			r4 = 9;
			r11 = r0->entities;
			if( r11 == NULL ) hl_null_access();
			r10 = haxe_ds_IntMap_iterator(r11);
			r12 = hl_to_virtual(&t$vrt_4adc768,(vdynamic*)r10);
			label$8f13fe2_8_29:
			if( r12 == NULL ) hl_null_access();
			if( hl_vfields(r12)[0] ) r13 = ((bool (*)(vdynamic*))hl_vfields(r12)[0])(r12->value); else {
				vdynamic ret;
				hl_dyn_call_obj(r12->value,&t$fun_bf7849e,407283053/*hasNext*/,NULL,&ret);
				r13 = (bool)ret.v.i;
			}
			if( !r13 ) goto label$8f13fe2_8_40;
			if( hl_vfields(r12)[1] ) r14 = ((vvirtual* (*)(vdynamic*))hl_vfields(r12)[1])(r12->value); else {
				r14 = (vvirtual*)hl_dyn_call_obj(r12->value,&t$fun_5150610,151160317/*next*/,NULL,NULL);
			}
			if( r14 == NULL ) hl_null_access();
			if( hl_vfields(r14)[2] ) r6 = ((int (*)(vdynamic*,int,haxe__io__Bytes))hl_vfields(r14)[2])(r14->value,r4,r1); else {
				void *args[] = {&r4,r1};
				vdynamic ret;
				hl_dyn_call_obj(r14->value,&t$fun_cac02b9,68205811/*_receive*/,args,&ret);
				r6 = (int)ret.v.i;
			}
			if( hl_vfields(r14)[0] ) r15 = ((int (*)(vdynamic*))hl_vfields(r14)[0])(r14->value); else {
				vdynamic ret;
				hl_dyn_call_obj(r14->value,&t$fun_4dc72d5,-10175328/*_size*/,NULL,&ret);
				r15 = (int)ret.v.i;
			}
			r6 = r4 + r15;
			r4 = r6;
			goto label$8f13fe2_8_29;
			label$8f13fe2_8_40:
			kha_Scheduler_warp(r9);
			goto label$8f13fe2_8_62;
		case 3:
			r4 = 1;
			r4 = haxe_io_Bytes_get(r1,r4);
			switch(r4) {
				default:
					goto label$8f13fe2_8_48;
				case 0:
					goto label$8f13fe2_8_48;
				case 1:
					kha_netsync_Session_executeRPC(r0,r1);
			}
			label$8f13fe2_8_48:
			goto label$8f13fe2_8_62;
		case 4:
			r4 = 1;
			r9 = haxe_io_Bytes_getFloat(r1,r4);
			r16 = kha_Scheduler_realTime();
			r16 = r16 - r9;
			r0->ping = r16;
			goto label$8f13fe2_8_62;
		case 5:
			r8 = r0->refusedCallback;
			if( r8 == NULL ) hl_null_access();
			r8->hasValue ? ((void (*)(vdynamic*))r8->fun)((vdynamic*)r8->value) : ((void (*)(void))r8->fun)();
			goto label$8f13fe2_8_62;
		case 6:
			r4 = 1;
			r4 = haxe_io_Bytes_getInt32(r1,r4);
			r0->currentPlayers = r4;
	}
	label$8f13fe2_8_62:
	return;
}

void kha_netsync_Session_executeRPC(kha__netsync__Session r0,haxe__io__Bytes r1) {
	String r10, r13, r14, r16, r27;
	hl__Class r29;
	vvirtual *r19, *r21;
	bool r22;
	haxe__$Log r18;
	kha__netsync__$SyncBuilder r30;
	double r24;
	vclosure *r17;
	hl__types__ArrayDyn r2, r23;
	int *r25;
	vdynamic *r20, *r28;
	vbyte *r8;
	int r4, r5, r6, r7, r9, r11, r12, r15, r26;
	r2 = (hl__types__ArrayDyn)hl_alloc_obj(&t$hl_types_ArrayDyn);
	hl_types_ArrayDyn_new(r2);
	if( r1 == NULL ) hl_null_access();
	r4 = 2;
	r4 = haxe_io_Bytes_getInt32(r1,r4);
	r5 = 6;
	r7 = 1;
	r6 = r5 + r7;
	r7 = r1->length;
	if( ((unsigned)r6) < ((unsigned)r7) ) goto label$8f13fe2_9_13;
	r7 = 0;
	r6 = r7;
	goto label$8f13fe2_9_16;
	label$8f13fe2_9_13:
	r8 = r1->b;
	r7 = *(unsigned short*)(r8 + r5);
	r6 = r7;
	label$8f13fe2_9_16:
	r9 = 2;
	r7 = r5 + r9;
	r5 = r7;
	r10 = (String)s$;
	r7 = 0;
	r9 = r6;
	label$8f13fe2_9_22:
	if( r7 >= r9 ) goto label$8f13fe2_9_32;
	++r7;
	if( r1 == NULL ) hl_null_access();
	r12 = haxe_io_Bytes_get(r1,r5);
	r14 = String_fromCharCode(r12);
	r13 = String___add__(r10,r14);
	r10 = r13;
	++r5;
	goto label$8f13fe2_9_22;
	label$8f13fe2_9_32:
	r9 = 1;
	r7 = r5 + r9;
	if( r1 == NULL ) hl_null_access();
	r9 = r1->length;
	if( ((unsigned)r7) < ((unsigned)r9) ) goto label$8f13fe2_9_40;
	r9 = 0;
	r7 = r9;
	goto label$8f13fe2_9_43;
	label$8f13fe2_9_40:
	r8 = r1->b;
	r9 = *(unsigned short*)(r8 + r5);
	r7 = r9;
	label$8f13fe2_9_43:
	r11 = 2;
	r9 = r5 + r11;
	r5 = r9;
	r13 = (String)s$;
	r9 = 0;
	r11 = r7;
	label$8f13fe2_9_49:
	if( r9 >= r11 ) goto label$8f13fe2_9_59;
	++r9;
	if( r1 == NULL ) hl_null_access();
	r15 = haxe_io_Bytes_get(r1,r5);
	r16 = String_fromCharCode(r15);
	r14 = String___add__(r13,r16);
	r13 = r14;
	++r5;
	goto label$8f13fe2_9_49;
	label$8f13fe2_9_59:
	if( r1 == NULL ) hl_null_access();
	r11 = r1->length;
	if( r5 >= r11 ) goto label$8f13fe2_9_211;
	r9 = haxe_io_Bytes_get(r1,r5);
	++r5;
	switch(r9) {
		default:
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
		case 5:
		case 6:
		case 7:
		case 8:
		case 9:
		case 10:
		case 11:
		case 12:
		case 13:
		case 14:
		case 15:
		case 16:
		case 17:
		case 18:
		case 19:
		case 20:
		case 21:
		case 22:
		case 23:
		case 24:
		case 25:
		case 26:
		case 27:
		case 28:
		case 29:
		case 30:
		case 31:
		case 32:
		case 33:
		case 34:
		case 35:
		case 36:
		case 37:
		case 38:
		case 39:
		case 40:
		case 41:
		case 42:
		case 43:
		case 44:
		case 45:
		case 46:
		case 47:
		case 48:
		case 49:
		case 50:
		case 51:
		case 52:
		case 53:
		case 54:
		case 55:
		case 56:
		case 57:
		case 58:
		case 59:
		case 60:
		case 61:
		case 62:
		case 63:
		case 64:
		case 65:
		case 67:
		case 68:
		case 69:
		case 71:
		case 72:
		case 74:
		case 75:
		case 76:
		case 77:
		case 78:
		case 79:
		case 80:
		case 81:
		case 82:
			r18 = (haxe__$Log)g$_haxe_Log;
			r17 = r18->trace;
			if( r17 == NULL ) hl_null_access();
			r14 = (String)s$Unknown_argument_type_;
			r19 = hl_alloc_virtual(&t$vrt_329ffa8);
			r16 = (String)s$kha_netsync_Session_hx;
			if( hl_vfields(r19)[1] ) *(String*)(hl_vfields(r19)[1]) = (String)r16; else hl_dyn_setp(r19->value,37969014/*fileName*/,&t$String,r16);
			r11 = 318;
			if( hl_vfields(r19)[2] ) *(int*)(hl_vfields(r19)[2]) = (int)r11; else hl_dyn_seti(r19->value,371360620/*lineNumber*/,&t$_i32,r11);
			r16 = (String)s$kha_netsync_Session;
			if( hl_vfields(r19)[0] ) *(String*)(hl_vfields(r19)[0]) = (String)r16; else hl_dyn_setp(r19->value,-63073762/*className*/,&t$String,r16);
			r16 = (String)s$executeRPC;
			if( hl_vfields(r19)[3] ) *(String*)(hl_vfields(r19)[3]) = (String)r16; else hl_dyn_setp(r19->value,302979532/*methodName*/,&t$String,r16);
			r21 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r19);
			r17->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r17->fun)((vdynamic*)r17->value,((vdynamic*)r14),r21) : ((void (*)(vdynamic*,vvirtual*))r17->fun)(((vdynamic*)r14),r21);
			goto label$8f13fe2_9_210;
		case 66:
			r11 = haxe_io_Bytes_get(r1,r5);
			r12 = 1;
			if( r11 == r12 ) goto label$8f13fe2_9_87;
			r22 = false;
			goto label$8f13fe2_9_88;
			label$8f13fe2_9_87:
			r22 = true;
			label$8f13fe2_9_88:
			++r5;
			r18 = (haxe__$Log)g$_haxe_Log;
			r17 = r18->trace;
			if( r17 == NULL ) hl_null_access();
			r14 = (String)s$Bool_;
			r20 = hl_alloc_dynbool(r22);
			r16 = Std_string(r20);
			r14 = String___add__(r14,r16);
			r19 = hl_alloc_virtual(&t$vrt_329ffa8);
			r16 = (String)s$kha_netsync_Session_hx;
			if( hl_vfields(r19)[1] ) *(String*)(hl_vfields(r19)[1]) = (String)r16; else hl_dyn_setp(r19->value,37969014/*fileName*/,&t$String,r16);
			r11 = 295;
			if( hl_vfields(r19)[2] ) *(int*)(hl_vfields(r19)[2]) = (int)r11; else hl_dyn_seti(r19->value,371360620/*lineNumber*/,&t$_i32,r11);
			r16 = (String)s$kha_netsync_Session;
			if( hl_vfields(r19)[0] ) *(String*)(hl_vfields(r19)[0]) = (String)r16; else hl_dyn_setp(r19->value,-63073762/*className*/,&t$String,r16);
			r16 = (String)s$executeRPC;
			if( hl_vfields(r19)[3] ) *(String*)(hl_vfields(r19)[3]) = (String)r16; else hl_dyn_setp(r19->value,302979532/*methodName*/,&t$String,r16);
			r21 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r19);
			r17->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r17->fun)((vdynamic*)r17->value,((vdynamic*)r14),r21) : ((void (*)(vdynamic*,vvirtual*))r17->fun)(((vdynamic*)r14),r21);
			if( r2 == NULL ) hl_null_access();
			r20 = hl_alloc_dynbool(r22);
			r11 = hl_types_ArrayDyn_push(r2,r20);
			goto label$8f13fe2_9_210;
		case 70:
			r24 = haxe_io_Bytes_getDouble(r1,r5);
			r12 = 8;
			r11 = r5 + r12;
			r5 = r11;
			r18 = (haxe__$Log)g$_haxe_Log;
			r17 = r18->trace;
			if( r17 == NULL ) hl_null_access();
			r14 = (String)s$Float_;
			r25 = &r11;
			r8 = hl_ftos(r24,r25);
			r16 = String___alloc__(r8,r11);
			r14 = String___add__(r14,r16);
			r19 = hl_alloc_virtual(&t$vrt_329ffa8);
			r16 = (String)s$kha_netsync_Session_hx;
			if( hl_vfields(r19)[1] ) *(String*)(hl_vfields(r19)[1]) = (String)r16; else hl_dyn_setp(r19->value,37969014/*fileName*/,&t$String,r16);
			r11 = 300;
			if( hl_vfields(r19)[2] ) *(int*)(hl_vfields(r19)[2]) = (int)r11; else hl_dyn_seti(r19->value,371360620/*lineNumber*/,&t$_i32,r11);
			r16 = (String)s$kha_netsync_Session;
			if( hl_vfields(r19)[0] ) *(String*)(hl_vfields(r19)[0]) = (String)r16; else hl_dyn_setp(r19->value,-63073762/*className*/,&t$String,r16);
			r16 = (String)s$executeRPC;
			if( hl_vfields(r19)[3] ) *(String*)(hl_vfields(r19)[3]) = (String)r16; else hl_dyn_setp(r19->value,302979532/*methodName*/,&t$String,r16);
			r21 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r19);
			r17->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r17->fun)((vdynamic*)r17->value,((vdynamic*)r14),r21) : ((void (*)(vdynamic*,vvirtual*))r17->fun)(((vdynamic*)r14),r21);
			if( r2 == NULL ) hl_null_access();
			r20 = hl_alloc_dynamic(&t$_f64);
			r20->v.d = r24;
			r11 = hl_types_ArrayDyn_push(r2,r20);
			goto label$8f13fe2_9_210;
		case 73:
			r11 = haxe_io_Bytes_getInt32(r1,r5);
			r15 = 4;
			r12 = r5 + r15;
			r5 = r12;
			r18 = (haxe__$Log)g$_haxe_Log;
			r17 = r18->trace;
			if( r17 == NULL ) hl_null_access();
			r14 = (String)s$Int_;
			r12 = r11;
			r25 = &r12;
			r8 = hl_itos(r12,r25);
			r16 = String___alloc__(r8,r12);
			r14 = String___add__(r14,r16);
			r19 = hl_alloc_virtual(&t$vrt_329ffa8);
			r16 = (String)s$kha_netsync_Session_hx;
			if( hl_vfields(r19)[1] ) *(String*)(hl_vfields(r19)[1]) = (String)r16; else hl_dyn_setp(r19->value,37969014/*fileName*/,&t$String,r16);
			r12 = 305;
			if( hl_vfields(r19)[2] ) *(int*)(hl_vfields(r19)[2]) = (int)r12; else hl_dyn_seti(r19->value,371360620/*lineNumber*/,&t$_i32,r12);
			r16 = (String)s$kha_netsync_Session;
			if( hl_vfields(r19)[0] ) *(String*)(hl_vfields(r19)[0]) = (String)r16; else hl_dyn_setp(r19->value,-63073762/*className*/,&t$String,r16);
			r16 = (String)s$executeRPC;
			if( hl_vfields(r19)[3] ) *(String*)(hl_vfields(r19)[3]) = (String)r16; else hl_dyn_setp(r19->value,302979532/*methodName*/,&t$String,r16);
			r21 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r19);
			r17->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r17->fun)((vdynamic*)r17->value,((vdynamic*)r14),r21) : ((void (*)(vdynamic*,vvirtual*))r17->fun)(((vdynamic*)r14),r21);
			if( r2 == NULL ) hl_null_access();
			r20 = hl_alloc_dynamic(&t$_i32);
			r20->v.i = r11;
			r12 = hl_types_ArrayDyn_push(r2,r20);
			goto label$8f13fe2_9_210;
		case 83:
			r12 = 1;
			r11 = r5 + r12;
			r12 = r1->length;
			if( ((unsigned)r11) < ((unsigned)r12) ) goto label$8f13fe2_9_173;
			r12 = 0;
			r11 = r12;
			goto label$8f13fe2_9_176;
			label$8f13fe2_9_173:
			r8 = r1->b;
			r12 = *(unsigned short*)(r8 + r5);
			r11 = r12;
			label$8f13fe2_9_176:
			r15 = 2;
			r12 = r5 + r15;
			r5 = r12;
			r14 = (String)s$;
			r12 = 0;
			r15 = r11;
			label$8f13fe2_9_182:
			if( r12 >= r15 ) goto label$8f13fe2_9_192;
			++r12;
			if( r1 == NULL ) hl_null_access();
			r26 = haxe_io_Bytes_get(r1,r5);
			r27 = String_fromCharCode(r26);
			r16 = String___add__(r14,r27);
			r14 = r16;
			++r5;
			goto label$8f13fe2_9_182;
			label$8f13fe2_9_192:
			r18 = (haxe__$Log)g$_haxe_Log;
			r17 = r18->trace;
			if( r17 == NULL ) hl_null_access();
			r16 = (String)s$String_;
			r16 = String___add__(r16,r14);
			r19 = hl_alloc_virtual(&t$vrt_329ffa8);
			r27 = (String)s$kha_netsync_Session_hx;
			if( hl_vfields(r19)[1] ) *(String*)(hl_vfields(r19)[1]) = (String)r27; else hl_dyn_setp(r19->value,37969014/*fileName*/,&t$String,r27);
			r12 = 315;
			if( hl_vfields(r19)[2] ) *(int*)(hl_vfields(r19)[2]) = (int)r12; else hl_dyn_seti(r19->value,371360620/*lineNumber*/,&t$_i32,r12);
			r27 = (String)s$kha_netsync_Session;
			if( hl_vfields(r19)[0] ) *(String*)(hl_vfields(r19)[0]) = (String)r27; else hl_dyn_setp(r19->value,-63073762/*className*/,&t$String,r27);
			r27 = (String)s$executeRPC;
			if( hl_vfields(r19)[3] ) *(String*)(hl_vfields(r19)[3]) = (String)r27; else hl_dyn_setp(r19->value,302979532/*methodName*/,&t$String,r27);
			r21 = hl_to_virtual(&t$vrt_eaa6a3b,(vdynamic*)r19);
			r17->hasValue ? ((void (*)(vdynamic*,vdynamic*,vvirtual*))r17->fun)((vdynamic*)r17->value,((vdynamic*)r16),r21) : ((void (*)(vdynamic*,vvirtual*))r17->fun)(((vdynamic*)r16),r21);
			if( r2 == NULL ) hl_null_access();
			r12 = hl_types_ArrayDyn_push(r2,((vdynamic*)r14));
	}
	label$8f13fe2_9_210:
	goto label$8f13fe2_9_59;
	label$8f13fe2_9_211:
	r11 = -1;
	if( r4 != r11 ) goto label$8f13fe2_9_220;
	r20 = NULL;
	r29 = Type_resolveClass(r10);
	r16 = (String)s$_remotely;
	r14 = String___add__(r13,r16);
	r28 = Reflect_field(((vdynamic*)r29),r14);
	r20 = Reflect_callMethod(r20,r28,r2);
	goto label$8f13fe2_9_232;
	label$8f13fe2_9_220:
	r30 = (kha__netsync__$SyncBuilder)g$_kha_netsync_SyncBuilder;
	r23 = r30->objects;
	if( r23 == NULL ) hl_null_access();
	r20 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r23->$type->vobj_proto[0])(r23,r4);
	r30 = (kha__netsync__$SyncBuilder)g$_kha_netsync_SyncBuilder;
	r23 = r30->objects;
	if( r23 == NULL ) hl_null_access();
	r28 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r23->$type->vobj_proto[0])(r23,r4);
	r16 = (String)s$_remotely;
	r14 = String___add__(r13,r16);
	r28 = Reflect_field(r28,r14);
	r20 = Reflect_callMethod(r20,r28,r2);
	label$8f13fe2_9_232:
	return;
}

void kha_netsync_Session_waitForStart__$1(venum* r0) {
	kha__netsync__Session r3;
	vclosure *r2;
	r2 = ((Enumt$ctx_33ddeca*)r0)->p0;
	if( r2 == NULL ) hl_null_access();
	r2->hasValue ? ((void (*)(vdynamic*))r2->fun)((vdynamic*)r2->value) : ((void (*)(void))r2->fun)();
	r3 = ((Enumt$ctx_33ddeca*)r0)->p1;
	if( r3 == NULL ) hl_null_access();
	kha_netsync_Session_reset(r3);
	return;
}

void kha_netsync_Session_waitForStart__$2(kha__netsync__Session r0,haxe__io__Bytes r1) {
	vvirtual *r3;
	if( r0 == NULL ) hl_null_access();
	r3 = NULL;
	kha_netsync_Session_receive(r0,r1,r3);
	return;
}

void kha_netsync_Session_waitForStart(kha__netsync__Session r0,vclosure* r1,vclosure* r2,vclosure* r3,vclosure* r4,vclosure* r5) {
	String r9;
	venum *r12;
	kha__netsync__Network r8;
	double r14, r15;
	vclosure *r7, *r11, *r13;
	double *r16, *r17;
	int r10;
	r0->startCallback = r1;
	r0->refusedCallback = r2;
	r0->resetCallback = r5;
	r8 = (kha__netsync__Network)hl_alloc_obj(&t$kha_netsync_Network);
	r9 = r0->address;
	r10 = r0->port;
	r12 = hl_alloc_enum(&t$ctx_33ddeca,0);
	((Enumt$ctx_33ddeca*)r12)->p0 = (vclosure*)r4;
	((Enumt$ctx_33ddeca*)r12)->p1 = (kha__netsync__Session)r0;
	r11 = hl_alloc_closure_ptr(&t$fun_2827253,kha_netsync_Session_waitForStart__$1,r12);
	kha_netsync_Network_new(r8,r9,r10,r3,r11);
	r0->network = r8;
	r8 = r0->network;
	if( r8 == NULL ) hl_null_access();
	r13 = hl_alloc_closure_ptr(&t$fun_8c19b3d,kha_netsync_Session_waitForStart__$2,r0);
	kha_netsync_Network_listen(r8,r13);
	r7 = hl_alloc_closure_ptr(&t$fun_35dbd9b,kha_netsync_Session_update,r0);
	r10 = 0;
	r10 = kha_Scheduler_addFrameTask(r7,r10);
	r0->updateTaskId = r10;
	r14 = 1.;
	r0->ping = r14;
	r7 = hl_alloc_closure_ptr(&t$fun_35dbd9b,kha_netsync_Session_sendPing,r0);
	r14 = 0.;
	r10 = 1;
	r15 = (double)r10;
	r16 = &r15;
	r17 = NULL;
	r10 = kha_Scheduler_addTimeTask(r7,r14,r16,r17);
	r0->pingTaskId = r10;
	return;
}

void kha_netsync_Session_reset(kha__netsync__Session r0) {
	haxe__ds__IntMap r4;
	vclosure *r5;
	double r3;
	int r2;
	r2 = r0->updateTaskId;
	kha_Scheduler_removeFrameTask(r2);
	r2 = r0->pingTaskId;
	kha_Scheduler_removeTimeTask(r2);
	r2 = 0;
	r0->currentPlayers = r2;
	r3 = 1.;
	r0->ping = r3;
	r4 = (haxe__ds__IntMap)hl_alloc_obj(&t$haxe_ds_IntMap);
	haxe_ds_IntMap_new(r4);
	r0->controllers = r4;
	r4 = (haxe__ds__IntMap)hl_alloc_obj(&t$haxe_ds_IntMap);
	haxe_ds_IntMap_new(r4);
	r0->entities = r4;
	r5 = r0->resetCallback;
	if( r5 == NULL ) hl_null_access();
	r5->hasValue ? ((void (*)(vdynamic*))r5->fun)((vdynamic*)r5->value) : ((void (*)(void))r5->fun)();
	return;
}

void kha_netsync_Session_update(kha__netsync__Session r0) {
	vvirtual *r1, *r3;
	haxe__io__Bytes r9, r14;
	bool r5;
	haxe__ds__IntMap r2;
	kha__netsync__Controller r6;
	double r10;
	int *r11;
	int r7, r8, r12, r13, r15;
	r2 = r0->controllers;
	if( r2 == NULL ) hl_null_access();
	r1 = haxe_ds_IntMap_iterator(r2);
	r3 = hl_to_virtual(&t$vrt_088a3ef,(vdynamic*)r1);
	label$8f13fe2_14_4:
	if( r3 == NULL ) hl_null_access();
	if( hl_vfields(r3)[0] ) r5 = ((bool (*)(vdynamic*))hl_vfields(r3)[0])(r3->value); else {
		vdynamic ret;
		hl_dyn_call_obj(r3->value,&t$fun_bf7849e,407283053/*hasNext*/,NULL,&ret);
		r5 = (bool)ret.v.i;
	}
	if( !r5 ) goto label$8f13fe2_14_49;
	if( hl_vfields(r3)[1] ) r6 = ((kha__netsync__Controller (*)(vdynamic*))hl_vfields(r3)[1])(r3->value); else {
		r6 = (kha__netsync__Controller)hl_dyn_call_obj(r3->value,&t$fun_7ea0805,151160317/*next*/,NULL,NULL);
	}
	if( r6 == NULL ) hl_null_access();
	r7 = r6->_inputBufferIndex;
	r8 = 0;
	if( r8 >= r7 ) goto label$8f13fe2_14_48;
	r7 = 22;
	r8 = r6->_inputBufferIndex;
	r7 = r7 + r8;
	r9 = haxe_io_Bytes_alloc(r7);
	if( r9 == NULL ) hl_null_access();
	r7 = 0;
	r8 = 2;
	haxe_io_Bytes_set(r9,r7,r8);
	r7 = 1;
	r8 = kha_netsync_Controller__id(r6);
	haxe_io_Bytes_setInt32(r9,r7,r8);
	r7 = 5;
	r10 = kha_Scheduler_time();
	haxe_io_Bytes_setDouble(r9,r7,r10);
	r7 = 13;
	r8 = 0;
	r11 = &r8;
	r8 = kha_System_windowWidth(r11);
	haxe_io_Bytes_setInt32(r9,r7,r8);
	r7 = 17;
	r12 = 0;
	r11 = &r12;
	r12 = kha_System_windowHeight(r11);
	haxe_io_Bytes_setInt32(r9,r7,r12);
	r7 = 21;
	r13 = 0;
	haxe_io_Bytes_set(r9,r7,r13);
	r7 = 22;
	r14 = r6->_inputBuffer;
	r13 = 0;
	r15 = r6->_inputBufferIndex;
	haxe_io_Bytes_blit(r9,r7,r14,r13,r15);
	kha_netsync_Session_sendToServer(r0,r9);
	r7 = 0;
	r6->_inputBufferIndex = r7;
	label$8f13fe2_14_48:
	goto label$8f13fe2_14_4;
	label$8f13fe2_14_49:
	return;
}

void kha_netsync_Session_sendToServer(kha__netsync__Session r0,haxe__io__Bytes r1) {
	bool r4;
	kha__netsync__Network r3;
	r3 = r0->network;
	if( r3 == NULL ) hl_null_access();
	r4 = false;
	kha_netsync_Network_send(r3,r1,r4);
	return;
}

void kha_netsync_Session_new(kha__netsync__Session r0,int r1,String r2,int r3) {
	kha__netsync__$Session r8;
	haxe__ds__IntMap r6;
	double r4;
	int r5;
	r4 = 1.;
	r0->ping = r4;
	r5 = 0;
	r0->currentPlayers = r5;
	r6 = (haxe__ds__IntMap)hl_alloc_obj(&t$haxe_ds_IntMap);
	haxe_ds_IntMap_new(r6);
	r0->controllers = r6;
	r6 = (haxe__ds__IntMap)hl_alloc_obj(&t$haxe_ds_IntMap);
	haxe_ds_IntMap_new(r6);
	r0->entities = r6;
	r8 = (kha__netsync__$Session)g$_kha_netsync_Session;
	r8->instance = r0;
	r0->maxPlayers = r1;
	r0->address = r2;
	r0->port = r3;
	return;
}

